{"title":"Diffie-Hellman Key Exchange","markdown":{"headingText":"Diffie-Hellman Key Exchange","headingAttr":{"id":"sec-Asymmetric","classes":[],"keyvalue":[]},"containsRefs":false,"markdown":"\nThe motivation for a key exchange scheme could be sharing the same key over a insecure environment, to let both two parties have a same value to put their symmetric encryption on. Diffie-Hellman is one of the best (also the first) key exchange scheme could do well in this purpose, in both sense of security and application. \n\n## Diffie-Hellman basic\n\nAssuming that Alice and Bob want to have a same key for their AES encryption over the conversation. \n\n+ First, Alice (or Bob) will establish two numbers: a big prime $p$ and its generator $g$. \n\n+ Next, Alice will choose a number $a \\in \\mathbb{Z}_p$, which will act as her private key, while Bob also choose a number $b \\in \\mathbb{Z}_p$. \n\n+ Then, both parties will compute their public number:\n\n$$\n\\displaylines{A \\equiv g^a \\pmod p \\\\ B \\equiv g^b \\pmod p}\n$$\n\nThen, Alice and Bob will send $A, B$ to the other. Remember, other adversary can know this value too. \n\n+ When having $B, A$, respectively, Alice and Bob is ready to have their common secret. \n\nFrom Alice's side:\n$$\nS \\equiv B^a \\equiv (g^b)^a \\equiv g^{ba} \\pmod p  \n$$\n\nIn the same way, Bob will find $A^b$. This two number is indeedly the same. Then, they have successfully find their common secret. \n\nThe security of Diffie-Hellman lies in the hard problem of discrete logarithm. For the adversary, with a good choice of $p$, they cannot find the private key of Alice & Bob (i. e. finding either $log_g(A) \\pmod p$ and  $log_g(B) \\pmod p$. In the same sense, this hardness is applied on Alice and Bob if they want to know the other's secret. \n\n## Cryptosystem built on Discrete Logarithm \n\nThere are some others cryptosystem (like RSA), that built on the Discrete Logarithm rather than the trapdoor function of factorization. One significant is [ElGamal](https://en.wikipedia.org/wiki/ElGamal_encryption).\n\n## Meet-in-the-middle \n\nNow, we will discuss about an attack in Diffie-Hellman Key Exchange. \n\nLet Mallory be the adversary, by some ways can interrupt and intimate the sharing scheme between Alice and Bob. \n\n![](/images/MITM.png)\n\nMallory will send his private key to Bob and Alice. And by this mean, the shared secret that Alice and Bob would compute is $g^{az}$ and $g^{bz}$, which Mallory also has.\n\nThen, Mallory would establish two secret connections between Alice and Bob, using these two shared secrets, and can read the plaintext between Alice and Bob. \n\nHowever, Mallory still cannot find back Alice and Bob secret key $a, b$. We will discuss this on the next chapter. \n"},"formats":{"html":{"execute":{"fig-width":7,"fig-height":5,"fig-format":"retina","fig-dpi":96,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"html","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":"auto","merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"standalone":true,"wrap":"none","default-image-extension":"png","to":"html","output-file":"DiffieHellman.html"},"language":{},"metadata":{"lang":"en","fig-responsive":true,"quarto-version":"1.2.280","bibliography":["references.bib"],"jupyter":{"kernelspec":{"name":"sagemath","language":"sagemath","display_name":"SageMath 9.6"}},"editor":{"render-on-save":true},"theme":"zephyr"},"extensions":{"book":{"multiFile":true}}},"pdf":{"execute":{"fig-width":5.5,"fig-height":3.5,"fig-format":"pdf","fig-dpi":300,"df-print":"default","error":false,"eval":true,"cache":null,"freeze":true,"echo":false,"output":true,"warning":true,"include":true,"keep-md":false,"keep-ipynb":false,"ipynb":null,"enabled":null,"daemon":null,"daemon-restart":false,"debug":false,"ipynb-filters":[],"engine":"markdown"},"render":{"keep-tex":false,"keep-source":false,"keep-hidden":false,"prefer-html":false,"output-divs":true,"output-ext":"pdf","fig-align":"default","fig-pos":null,"fig-env":null,"code-fold":"none","code-overflow":"scroll","code-link":false,"code-line-numbers":false,"code-tools":false,"tbl-colwidths":true,"merge-includes":true,"latex-auto-mk":true,"latex-auto-install":true,"latex-clean":true,"latex-max-runs":10,"latex-makeindex":"makeindex","latex-makeindex-opts":[],"latex-tlmgr-opts":[],"latex-input-paths":[],"latex-output-dir":null,"link-external-icon":false,"link-external-newwindow":false,"self-contained-math":false,"format-resources":[]},"pandoc":{"pdf-engine":"xelatex","standalone":true,"variables":{"graphics":true,"tables":true},"default-image-extension":"pdf","to":"pdf","toc":true,"highlight-style":"github","output-file":"DiffieHellman.pdf"},"language":{},"metadata":{"block-headings":true,"bibliography":["references.bib"],"jupyter":{"kernelspec":{"name":"sagemath","language":"sagemath","display_name":"SageMath 9.6"}},"editor":{"render-on-save":true},"documentclass":"scrbook","papersize":"A4"},"extensions":{"book":{}}}}}